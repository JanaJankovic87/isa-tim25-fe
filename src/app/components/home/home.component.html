<div class="page-container">
  <!-- NAVBAR -->
  <nav class="navbar">
    <div class="navbar-left">
      <button class="menu-btn"></button>
    </div>
    <div class="navbar-center">
      <div class="search-container">
        <input type="text" placeholder="Search" class="search-input">
        <button class="search-btn">
          <svg width="24" height="24" viewBox="0 0 24 24">
            <path fill="currentColor" d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
          </svg>
        </button>
      </div>
    </div>

    <div class="navbar-right">
      <a *ngIf="!authService.isLoggedIn()" class="sign-in-btn" routerLink="/login">
        <svg width="24" height="24" viewBox="0 0 24 24">
          <path fill="currentColor" d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
        </svg>
        Sign in
      </a>
      
      <div *ngIf="authService.isLoggedIn()" class="user-menu">
        <button class="add-video-btn" (click)="onAddVideo()">
          <svg width="24" height="24" viewBox="0 0 24 24">
            <path fill="currentColor" d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4zM14 13h-3v3H9v-3H6v-2h3V8h2v3h3v2z"/>
          </svg>
          Add Video
        </button>
        
        <!-- Profile Dropdown -->
        <div class="profile-dropdown">
          <button class="profile-btn" (click)="toggleProfileMenu()">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path fill="currentColor" d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
            </svg>
          </button>
          
          <div *ngIf="showProfileMenu" class="dropdown-menu">
            <a routerLink="/profile" class="dropdown-item" (click)="closeProfileMenu()">
              <svg width="20" height="20" viewBox="0 0 24 24">
                <path fill="currentColor" d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
              </svg>
              My Profile
            </a>
            
            <a href="#" class="dropdown-item" (click)="closeProfileMenu(); showMyVideos()">
                         
                            <svg width="20" height="20" viewBox="0 0 24 24">
                              <path fill="currentColor" d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/>
                            </svg>
                            My Videos
                          
             
            </a>
            
            <div class="dropdown-divider"></div>
            
            <button class="dropdown-item logout-item" (click)="onLogout()">
              <svg width="20" height="20" viewBox="0 0 24 24">
                <path fill="currentColor" d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
              </svg>
              Logout
            </button>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- CONTENT -->
  <div class="content">
    
    <!-- Skeleton Loader -->
    <div *ngIf="isLoading" class="video-grid">
      <div *ngFor="let i of [1,2,3,4,5,6,7,8]" class="video-card skeleton">
        <div class="thumbnail-skeleton"></div>
        <div class="video-info">
          <div class="title-skeleton"></div>
          <div class="title-skeleton short"></div>
          <div class="meta-skeleton"></div>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading && videos.length === 0" class="empty-state">
      <svg width="120" height="120" viewBox="0 0 24 24">
        <path fill="currentColor" d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/>
      </svg>
      <h2>No videos yet</h2>
      <p>Be the first to upload a video!</p>
    </div>

    <!-- Video Grid -->
    <div *ngIf="!isLoading && videos.length > 0" class="video-grid">
      <div 
        *ngFor="let video of videos" 
        class="video-card"
        (click)="viewVideo(video.id!)"
        style="position: relative;"
      >
        <div class="thumbnail-container">
          <img 
            [src]="getThumbnailUrl(video.id!)" 
            [alt]="video.title"
            class="thumbnail"
            (error)="$event.target.src='https://via.placeholder.com/320x180?text=No+Thumbnail'"
          >
          <video 
            #videoPlayer
            [src]="getVideoUrl(video.id!)"
            (loadedmetadata)="onLoadedMetadata($event, video.id!)"
            style="display: none;"
          ></video>
          <div class="duration-badge">{{ videoDurations[video.id!] || '0:00' }}</div>
        </div>

        <div class="video-info">
          <h3 class="video-title">{{ video.title }}</h3>
          <p class="video-description">{{ video.description }}</p>
          
          <div class="video-meta">
            <span>{{ formatDate(video.createdAt) }}</span>
            <span *ngIf="video.location"> â€¢ {{ video.location }}</span>
          </div>

          <div class="video-tags">
            <span *ngFor="let tag of video.tags" class="tag">#{{ tag }}</span>
          </div>

          <!-- Dugme za brisanje samo za videe trenutnog korisnika -->
          <button 
            *ngIf="video.userId === getCurrentUserId()"
            (click)="$event.stopPropagation(); deleteVideo(video.id!)"
            class="delete-btn"
            title="Delete video"
          >
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" fill="#ffb3b3" stroke="#a00" stroke-width="1.5"/>
              <line x1="9" y1="9" x2="15" y2="15" stroke="#a00" stroke-width="2" stroke-linecap="round"/>
              <line x1="15" y1="9" x2="9" y2="15" stroke="#a00" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>
        </div>
      </div>
    </div>

  </div>
</div>